<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

 <mapper namespace="com.board.dao.board-mapper">
  
    <select id="boardListData" resultType="Board" parameterType="java.util.Map">
    	SELECT bno,bsub,bname,dbday,bfilename,brec,num
    	FROM (SELECT bno,bsub,bname,TO_CHAR(bregdate,'YYYY-MM-DD') as dbday ,bfilename,brec,rownum as num
    	FROM(SELECT bno,bsub,bname,bregdate,bfilename,brec
    	FROM pboard ORDER BY bno DESC))
    	WHERE num BETWEEN #{start} AND #{end} 
    </select>
    <select id="boardRowCount" resultType="int">
    	SELECT count(*) from pboard
    	
    </select>
    <!--  데이터 추가 -->
    <insert id="boardInsert" parameterType="Board">
      <!-- Sequence -->
      <selectKey keyProperty="bno" resultType="int" order="BEFORE">
        SELECT NVL(MAX(bno)+1,1) as bno FROM pboard
      </selectKey>
      INSERT INTO pboard VALUES(
        1,#{bno},#{bname},#{bcont},#{bsub},#{bpwd},0,0,#{bfilename},
        SYSDATE,0)
    </insert>
     <sql id="where-no">
      WHERE bno=#{bno}
    </sql>
     <update id="boardHitIncrement" parameterType="int">
      UPDATE pboard SET
      bhit=bhit+1
      <include refid="where-no"/>
      <!-- ps.setInt(1,no) -->
    </update>
    <!-- 내용보기 데이터 출력  -->
    <select id="boardContentData" resultType="Board" parameterType="int">
     SELECT bno,bname,bsub,bcont,TO_CHAR(bregdate,'YYYY-MM-DD') as dbday, bhit,bfilename 
     FROM pboard
     <include refid="where-no"/>
    </select>
 </mapper>
 
 
 
 
 
 
 
 